import { Client, HierarchyRow, CustomField } from "@/types";

export const mockClients: Client[] = [
  {
    id: "1",
    name: "Koncious",
    status: "disabled",
    spend: 141201.64,
    impressions: 4444013,
    cpm: 31.77,
    clicks: 98656,
    cpc: 1.43,
    ctr: 2.22,
    purchases: 857,
    cpa: 164.76,
    roas: 1.15,
    platformPurchases: 1041,
    platformPurchasesDelta: -17.68,
    targetDelta: -61367.87,
    targetDeltaPercent: -43.46,
    budgetToday: 5158404.40,
    budget: 0,
  },
  {
    id: "2",
    name: "Vitality Now",
    status: "active",
    spend: 25000.0,
    impressions: 800000,
    cpm: 31.25,
    clicks: 20000,
    cpc: 1.25,
    ctr: 2.5,
    purchases: 200,
    cpa: 125.0,
    roas: 1.3,
    platformPurchases: 220,
    platformPurchasesDelta: -9.09,
    targetDelta: -5000.0,
    targetDeltaPercent: -20.0,
    budgetToday: 500000.0,
    budget: 100000.0,
  },
  {
    id: "3",
    name: "Pup Labs",
    status: "active",
    spend: 18000.0,
    impressions: 600000,
    cpm: 30.0,
    clicks: 15000,
    cpc: 1.2,
    ctr: 2.5,
    purchases: 150,
    cpa: 120.0,
    roas: 1.4,
    platformPurchases: 165,
    platformPurchasesDelta: -9.09,
    targetDelta: -3000.0,
    targetDeltaPercent: -16.67,
    budgetToday: 300000.0,
    budget: 80000.0,
  },
  {
    id: "4",
    name: "SciatiEase Labs",
    status: "active",
    spend: 15000.0,
    impressions: 500000,
    cpm: 30.0,
    clicks: 12500,
    cpc: 1.2,
    ctr: 2.5,
    purchases: 125,
    cpa: 120.0,
    roas: 1.35,
    platformPurchases: 138,
    platformPurchasesDelta: -9.42,
    targetDelta: -2500.0,
    targetDeltaPercent: -16.67,
    budgetToday: 250000.0,
    budget: 70000.0,
  },
  {
    id: "5",
    name: "Natural Living Now",
    status: "active",
    spend: 12000.0,
    impressions: 400000,
    cpm: 30.0,
    clicks: 10000,
    cpc: 1.2,
    ctr: 2.5,
    purchases: 100,
    cpa: 120.0,
    roas: 1.3,
    platformPurchases: 110,
    platformPurchasesDelta: -9.09,
    targetDelta: -2000.0,
    targetDeltaPercent: -16.67,
    budgetToday: 200000.0,
    budget: 60000.0,
  },
  {
    id: "6",
    name: "Dane",
    status: "disabled",
    spend: 8000.0,
    impressions: 250000,
    cpm: 32.0,
    clicks: 6000,
    cpc: 1.33,
    ctr: 2.4,
    purchases: 60,
    cpa: 133.33,
    roas: 1.2,
    platformPurchases: 70,
    platformPurchasesDelta: -14.29,
    targetDelta: -1500.0,
    targetDeltaPercent: -18.75,
    budgetToday: 150000.0,
    budget: 0,
  },
  {
    id: "7",
    name: "WebSeeds",
    status: "active",
    spend: 10000.0,
    impressions: 320000,
    cpm: 31.25,
    clicks: 8000,
    cpc: 1.25,
    ctr: 2.5,
    purchases: 80,
    cpa: 125.0,
    roas: 1.35,
    platformPurchases: 88,
    platformPurchasesDelta: -9.09,
    targetDelta: -1800.0,
    targetDeltaPercent: -18.0,
    budgetToday: 180000.0,
    budget: 50000.0,
  },
  {
    id: "8",
    name: "Primal Labs",
    status: "active",
    spend: 9000.0,
    impressions: 300000,
    cpm: 30.0,
    clicks: 7500,
    cpc: 1.2,
    ctr: 2.5,
    purchases: 75,
    cpa: 120.0,
    roas: 1.4,
    platformPurchases: 83,
    platformPurchasesDelta: -9.64,
    targetDelta: -1500.0,
    targetDeltaPercent: -16.67,
    budgetToday: 160000.0,
    budget: 45000.0,
  },
  {
    id: "9",
    name: "Advanced Bionutritionals",
    status: "active",
    spend: 11000.0,
    impressions: 350000,
    cpm: 31.43,
    clicks: 8750,
    cpc: 1.26,
    ctr: 2.5,
    purchases: 88,
    cpa: 125.0,
    roas: 1.32,
    platformPurchases: 97,
    platformPurchasesDelta: -9.28,
    targetDelta: -2000.0,
    targetDeltaPercent: -18.18,
    budgetToday: 170000.0,
    budget: 55000.0,
  },
  {
    id: "10",
    name: "Live Anabolic",
    status: "active",
    spend: 7500.0,
    impressions: 240000,
    cpm: 31.25,
    clicks: 6000,
    cpc: 1.25,
    ctr: 2.5,
    purchases: 60,
    cpa: 125.0,
    roas: 1.3,
    platformPurchases: 66,
    platformPurchasesDelta: -9.09,
    targetDelta: -1200.0,
    targetDeltaPercent: -16.0,
    budgetToday: 140000.0,
    budget: 40000.0,
  },
  {
    id: "11",
    name: "AV Labs",
    status: "active",
    spend: 8500.0,
    impressions: 270000,
    cpm: 31.48,
    clicks: 6750,
    cpc: 1.26,
    ctr: 2.5,
    purchases: 68,
    cpa: 125.0,
    roas: 1.28,
    platformPurchases: 75,
    platformPurchasesDelta: -9.33,
    targetDelta: -1400.0,
    targetDeltaPercent: -16.47,
    budgetToday: 150000.0,
    budget: 42000.0,
  },
  {
    id: "12",
    name: "Hero Co",
    status: "active",
    spend: 7000.0,
    impressions: 220000,
    cpm: 31.82,
    clicks: 5500,
    cpc: 1.27,
    ctr: 2.5,
    purchases: 55,
    cpa: 127.27,
    roas: 1.25,
    platformPurchases: 61,
    platformPurchasesDelta: -9.84,
    targetDelta: -1100.0,
    targetDeltaPercent: -15.71,
    budgetToday: 130000.0,
    budget: 38000.0,
  },
  {
    id: "13",
    name: "AlphaLion",
    status: "active",
    spend: 6500.0,
    impressions: 205000,
    cpm: 31.71,
    clicks: 5125,
    cpc: 1.27,
    ctr: 2.5,
    purchases: 51,
    cpa: 127.45,
    roas: 1.22,
    platformPurchases: 56,
    platformPurchasesDelta: -8.93,
    targetDelta: -1000.0,
    targetDeltaPercent: -15.38,
    budgetToday: 120000.0,
    budget: 35000.0,
  },
];

function makePlatformChildren(base: Client, prefix: string): HierarchyRow[] {
  const platforms = ["Google", "Facebook", "TikTok"];
  return platforms.map((plat, idx) => ({
    ...base,
    id: `${prefix}-${idx + 1}`,
    name: plat,
    level: "platform" as const,
    children: [
      {
        ...base,
        id: `${prefix}-${idx + 1}-1`,
        name: `${plat} Ad Account 1`,
        level: "adAccount" as const,
        status: "active",
      },
      {
        ...base,
        id: `${prefix}-${idx + 1}-2`,
        name: `${plat} Ad Account 2`,
        level: "adAccount" as const,
        status: "active",
      },
    ],
  }));
}

function makeBrandChildren(base: Client): HierarchyRow[] {
  const brands = ["Brand A", "Brand B", "Brand C"];
  return brands.map((brand, idx) => ({
    ...base,
    id: `${base.id}-b${idx + 1}`,
    name: brand,
    level: "brand" as const,
    status: "active",
    children: makePlatformChildren(base, `${base.id}-b${idx + 1}`),
  }));
}

export const hierarchyData: HierarchyRow[] = mockClients.slice(0, 10).map((client) => ({
  ...client,
  level: "client",
  children: makeBrandChildren(client),
  customMetrics: {
    "After Fee CPA": Math.round(client.cpa * 1.05 * 100) / 100,
    "After Fee ROAS": Math.round(client.roas * 0.95 * 100) / 100,
  },
}));

export const customFields: CustomField[] = [
  "After Fee CPA",
  "After Fee ROAS",
  "AOV",
  "Asset ID",
  "CPOPV",
  "CPP",
  "CVR",
  "EPC",
  "OPV",
  "OPV CVR",
  "Platform Rev.",
  "Platform ROAS",
  "Frequency",
  "Reach",
  "Revenue",
  "See More Rate",
  "Start Date",
  "Suggested tCPA",
  "Suggested tROAS",
  "Target ROAS",
  "AOV New Customers",
  "AOV Existing Customers",
  "ROAS New Customers",
  "ROAS Existing Customers",
  "CVR New Customers",
  "CVR Existing Customers",
  "CPA New Customers",
  "CPA Existing Customers",
  "New Customers",
  "Existing Customers",
  "Revenue New Customers",
  "Revenue Existing Customers",
].map((label, idx) => ({ id: `cf-${idx}`, label }));

export function getTotalMetrics(clients: Client[]): Client {
  const total = clients.reduce(
    (acc, client) => ({
      spend: acc.spend + client.spend,
      impressions: acc.impressions + client.impressions,
      clicks: acc.clicks + client.clicks,
      purchases: acc.purchases + client.purchases,
      targetDelta: acc.targetDelta + client.targetDelta,
      budgetToday: acc.budgetToday + client.budgetToday,
    }),
    {
      spend: 0,
      impressions: 0,
      clicks: 0,
      purchases: 0,
      targetDelta: 0,
      budgetToday: 0,
    }
  );

  return {
    id: "total",
    name: "Total",
    status: "active",
    spend: total.spend,
    impressions: total.impressions,
    cpm: total.impressions > 0 ? (total.spend / total.impressions) * 1000 : 0,
    clicks: total.clicks,
    cpc: total.clicks > 0 ? total.spend / total.clicks : 0,
    ctr: total.impressions > 0 ? (total.clicks / total.impressions) * 100 : 0,
    purchases: total.purchases,
    cpa: total.purchases > 0 ? total.spend / total.purchases : 0,
    roas: 1.25, // Calculated separately
    platformPurchases: 0,
    targetDelta: total.targetDelta,
    targetDeltaPercent:
      total.spend > 0 ? (total.targetDelta / total.spend) * 100 : 0,
    budgetToday: total.budgetToday,
    budget: 0,
  };
}


